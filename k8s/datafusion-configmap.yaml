apiVersion: v1
kind: ConfigMap
metadata:
  name: datafusion-config
  namespace: default
  labels:
    app: pekko-server
    component: datafusion
data:
  # DataFusion基础配置
  DATAFUSION_ENABLED: "true"
  DATAFUSION_HOST: "datafusion-service"
  DATAFUSION_PORT: "50051"
  
  # 连接池配置
  DATAFUSION_POOL_MAX_TOTAL: "15"
  DATAFUSION_POOL_MAX_IDLE: "8"
  DATAFUSION_POOL_MIN_IDLE: "3"
  DATAFUSION_POOL_CONNECT_TIMEOUT: "10000"
  DATAFUSION_POOL_REQUEST_TIMEOUT: "45000"
  
  # 查询配置
  DATAFUSION_QUERY_DEFAULT_BATCH_SIZE: "1000"
  DATAFUSION_QUERY_DEFAULT_TIMEOUT: "45"
  DATAFUSION_QUERY_MAX_RETRIES: "3"
  DATAFUSION_QUERY_RETRY_DELAY: "2000"
  
  # 监控配置
  DATAFUSION_METRICS_ENABLED: "true"
  DATAFUSION_STRUCTURED_LOGGING: "true"
  DATAFUSION_SLOW_QUERY_THRESHOLD: "8000"
  
  # 健康检查配置
  DATAFUSION_HEALTH_CHECK_INTERVAL: "30"
  DATAFUSION_HEALTH_CHECK_TIMEOUT: "8000"
  DATAFUSION_HEALTH_CHECK_FAILURE_THRESHOLD: "3"

---
apiVersion: v1
kind: ConfigMap
metadata:
  name: datafusion-config-dev
  namespace: default
  labels:
    app: pekko-server
    component: datafusion
    environment: development
data:
  # 开发环境配置
  DATAFUSION_ENABLED: "true"
  DATAFUSION_HOST: "localhost"
  DATAFUSION_PORT: "50051"
  
  # 开发环境连接池配置（较小）
  DATAFUSION_POOL_MAX_TOTAL: "5"
  DATAFUSION_POOL_MAX_IDLE: "3"
  DATAFUSION_POOL_MIN_IDLE: "1"
  DATAFUSION_POOL_CONNECT_TIMEOUT: "5000"
  DATAFUSION_POOL_REQUEST_TIMEOUT: "30000"
  
  # 开发环境查询配置
  DATAFUSION_QUERY_DEFAULT_BATCH_SIZE: "100"
  DATAFUSION_QUERY_DEFAULT_TIMEOUT: "60"
  DATAFUSION_QUERY_MAX_RETRIES: "2"
  DATAFUSION_QUERY_RETRY_DELAY: "500"
  
  # 开发环境监控配置
  DATAFUSION_METRICS_ENABLED: "true"
  DATAFUSION_STRUCTURED_LOGGING: "true"
  DATAFUSION_SLOW_QUERY_THRESHOLD: "2000"
  
  # 开发环境健康检查配置
  DATAFUSION_HEALTH_CHECK_INTERVAL: "10"
  DATAFUSION_HEALTH_CHECK_TIMEOUT: "3000"
  DATAFUSION_HEALTH_CHECK_FAILURE_THRESHOLD: "2"

---
apiVersion: v1
kind: ConfigMap
metadata:
  name: datafusion-config-prod
  namespace: default
  labels:
    app: pekko-server
    component: datafusion
    environment: production
data:
  # 生产环境配置
  DATAFUSION_ENABLED: "true"
  DATAFUSION_HOST: "datafusion-service"
  DATAFUSION_PORT: "50051"
  
  # 生产环境连接池配置（较大）
  DATAFUSION_POOL_MAX_TOTAL: "20"
  DATAFUSION_POOL_MAX_IDLE: "10"
  DATAFUSION_POOL_MIN_IDLE: "5"
  DATAFUSION_POOL_CONNECT_TIMEOUT: "5000"
  DATAFUSION_POOL_REQUEST_TIMEOUT: "30000"
  
  # 生产环境查询配置
  DATAFUSION_QUERY_DEFAULT_BATCH_SIZE: "1000"
  DATAFUSION_QUERY_DEFAULT_TIMEOUT: "30"
  DATAFUSION_QUERY_MAX_RETRIES: "3"
  DATAFUSION_QUERY_RETRY_DELAY: "1000"
  
  # 生产环境监控配置
  DATAFUSION_METRICS_ENABLED: "true"
  DATAFUSION_STRUCTURED_LOGGING: "true"
  DATAFUSION_SLOW_QUERY_THRESHOLD: "10000"
  
  # 生产环境健康检查配置
  DATAFUSION_HEALTH_CHECK_INTERVAL: "60"
  DATAFUSION_HEALTH_CHECK_TIMEOUT: "5000"
  DATAFUSION_HEALTH_CHECK_FAILURE_THRESHOLD: "5"