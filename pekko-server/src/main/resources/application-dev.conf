# 开发环境配置
# 使用方式: -Dconfig.resource=application-dev.conf

include "application.conf"

pekko {
  # 开发环境系统名称
  pekko-sys = "pekko-cluster-system-dev"
  
  # 集群配置
  cluster {
    # 开发环境种子节点（单节点）
    seed-nodes = ["pekko://pekko-cluster-system-dev@127.0.0.1:2551"]
    
    # 开发环境角色
    roles = ["coordinator", "worker", "api-gateway"]
    
    # 开发环境快速故障检测
    failure-detector {
      acceptable-heartbeat-pause = 2s
      threshold = 8.0
    }
    
    # 开发环境快速downing
    auto-down-unreachable-after = 5s
    
    # Cluster Sharding配置
    sharding {
      # 开发环境使用较少的分片
      number-of-shards = 10
      
      # 开发环境快速Passivation
      passivate-idle-entity-after = 5m
      
      # 开发环境快速再平衡
      rebalance-interval = 5s
    }
  }
  
  # 远程配置
  remote {
    artery {
      canonical {
        hostname = ${?PEKKO_HOSTNAME}
        hostname = "127.0.0.1"
        port = ${?PEKKO_PORT}
        port = 2551
      }
    }
  }
  
  # 开发环境持久化配置（使用内存存储）
  persistence {
    journal {
      plugin = "pekko.persistence.journal.inmem"
      inmem {
        test-serialization = on
      }
    }
    
    snapshot-store {
      plugin = "pekko.persistence.snapshot-store.local"
      local {
        dir = "target/dev-snapshots"
      }
    }
  }
  
  # 工作流事件溯源配置
  workflow {
    event-sourcing {
      # 开发环境更频繁的快照
      snapshot-every = 50
      keep-n-snapshots = 2
    }
  }
  
  # 日志配置（开发环境详细日志）
  loglevel = "DEBUG"
  stdout-loglevel = "DEBUG"
  
  # 开发环境日志配置
  loggers = ["org.apache.pekko.event.slf4j.Slf4jLogger"]
  logging-filter = "org.apache.pekko.event.slf4j.Slf4jLoggingFilter"
}
